{"version":3,"file":"../mailcheck-init-142-beta-14.min.js","sources":["mailcheck-init-142-beta-14.js"],"sourcesContent":["/**\n * Handles Mailcheck runs on email fields\n */\n(function (root, factory) {\n\tif ( typeof define === 'function' && define.amd ) {\n\t\tdefine([], factory(root));\n\t} else if ( typeof exports === 'object' ) {\n\t\tmodule.exports = factory(root);\n\t} else {\n\t\troot.MailcheckInit = factory(root);\n\t}\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\n\n\t'use strict';\n\n\tvar $ = jQuery;\n\n\tvar _hasInitialized = false;\n\tvar _publicMethods = { }\n\tvar _settings = {\n\t\tmailFieldSelector: '[data-mailcheck]',\n\t\tmailFieldSuggestedClass: 'has-email-suggestion',\n\t\tformFieldWrapperSelector: '.form-row',\n\t\tsuggestionElementSelector: '[data-mailcheck-suggestion]',\n\t\tsuggestionApplySelector: '[data-mailcheck-apply]',\n\t\tsuggestionValueAttr: 'data-suggestion-value',\n\t\tsuggestedElementTemplate: '<div class=\"fc-mailcheck-suggestion\" data-mailcheck-suggestion>Did you mean <a class=\"mailcheck-suggestion\" href=\"#apply-suggestion\" data-mailcheck-apply data-suggestion-value=\"{suggestion-value}\">{suggestion}</a>?</div>',\n\t\tsuggestionTemplate: '{address}@<span class=\"mailcheck-suggestion-domain\">{domain}</span>',\n\t}\n\tvar _key = {\n\t\tENTER: 'Enter',\n\t\tSPACE: ' ',\n\t}\n\tvar _tempTarget = null;\n\n\n\n\t/**\n\t * METHODS\n\t */\n\n\n\n\t/*!\n\t* Merge two or more objects together.\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\n\t* @param   {Object}   objects  The objects to merge together\n\t* @returns {Object}            Merged values of defaults and options\n\t*/\n\tvar extend = function () {\n\t\t// Variables\n\t\tvar extended = {};\n\t\tvar deep = false;\n\t\tvar i = 0;\n\n\t\t// Check if a deep merge\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tvar merge = function (obj) {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\t// If property is an object, merge properties\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar obj = arguments[i];\n\t\t\tmerge(obj);\n\t\t}\n\n\t\treturn extended;\n    };\n\n\n\n\t/**\n\t * Remove Mailcheck suggestions elements\n\t */\n\tvar removeSuggestions = function() {\n\t\tif ( _tempTarget === null ) return;\n\t\t\n\t\tvar parent = _tempTarget.parentNode;\n\t\tvar suggestions = parent.querySelectorAll( _settings.suggestionElementSelector );\n\t\t\n\t\tfor ( var i = 0; i < suggestions.length; i++ ) {\n\t\t\tsuggestions[i].parentNode.removeChild( suggestions[i] );\n\t\t}\n\n\t\t_tempTarget.classList.remove( _settings.mailFieldSuggestedClass );\n\t}\n\n\n\n\t/**\n\t * Add Mailcheck suggestions elements\n\t */\n\tvar handleSuggested = function( suggestion ) {\n\t\tremoveSuggestions();\n\n\t\tif ( _tempTarget === null ) return;\n\n\t\tvar suggestionHtml = _settings.suggestionTemplate.replaceAll( '{address}', suggestion.address ).replaceAll( '{domain}', suggestion.domain );\n\t\tvar suggestedElementHtml = _settings.suggestedElementTemplate.replaceAll( '{suggestion}', suggestionHtml ).replaceAll( '{suggestion-value}', suggestion.full );\n\n\t\t// Create suggestion element and add it after the field\n\t\tvar parent = _tempTarget.parentNode;\n\t\tvar element = document.createElement( 'div' );\n\t\telement.innerHTML = suggestedElementHtml;\n\t\tparent.insertBefore( element.firstChild, _tempTarget.nextSibling );\n\t\telement = null;\n\n\t\t_tempTarget.classList.add( _settings.mailFieldSuggestedClass );\n\t}\n\n\n\n\t/**\n\t * Apply an email suggestion value to the email field\n\t */\n\tvar applySuggestion = function( suggestionElement ){\n\t\t// Bail if there are no suggestions\n\t\tif ( suggestionElement === null ) return;\n\n\t\tvar parentFormRow = suggestionElement.closest( _settings.formFieldWrapperSelector );\n\t\t\n\t\t// Bail if parent form row not found\n\t\tif ( parentFormRow === null ) return;\n\n\t\tvar targetField = parentFormRow.querySelector( _settings.mailFieldSelector )\n\n\t\t// Bail if target field not found\n\t\tif ( targetField === null ) return;\n\n\t\t// Apply suggested value\n\t\ttargetField.value = suggestionElement.getAttribute( _settings.suggestionValueAttr );\n\t\t\n\t\t// Remove suggestion message\n\t\t_tempTarget = targetField;\n\t\tremoveSuggestions();\n\t\t_tempTarget = null;\n\n\t\t// Refocus on the target field\n\t\ttargetField.focus();\n\n\t\t// Revalidate the field\n\t\tif ( window.CheckoutValidation ) {\n\t\t\tCheckoutValidation.validateField( targetField );\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Handle captured keyup event and route to appropriate function.\n\t * @param  {Event} e Event data.\n\t */\n\tvar handleTriggerEvents = function( e ) {\n\t\tif ( Mailcheck !== undefined && e.target.matches( _settings.mailFieldSelector ) ) {\n\t\t\t_tempTarget = e.target;\n\n\t\t\tMailcheck.run( {\n\t\t\t\temail: _tempTarget.value,\n\t\t\t\tsuggested: handleSuggested,\n\t\t\t\tempty: removeSuggestions\n\t\t\t} );\n\n\t\t\t_tempTarget = null;\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Handle document clicks and route to the appropriate function.\n\t */\n\tvar handleClick = function( e ) {\n\t\tif ( e.target.closest( _settings.suggestionApplySelector ) ) {\n\t\t\te.preventDefault();\n\t\t\tapplySuggestion( e.target.closest( _settings.suggestionApplySelector ) );\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Handle keypress event.\n\t */\n\tvar handleKeyDown = function( e ) {\n\t\t// Should do nothing if the default action has been cancelled\n\t\tif ( e.defaultPrevented ) { return; }\n\n\t\t// ENTER or SPACE on apply-suggestion element\n\t\tif ( ( e.key == _key.ENTER || e.key == _key.SPACE ) && e.target.closest( _settings.suggestionApplySelector ) ) {\n\t\t\t// Similate click\n\t\t\thandleClick( e );\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Initialize Mailcheck feature\n\t */\n\t_publicMethods.init = function( options ) {\n\t\tif ( _hasInitialized ) return;\n\n\t\t// Merge settings\n\t\t_settings = extend( true, _settings, options );\n\n\t\t// Add event listeners\n\t\twindow.addEventListener( 'keyup', handleTriggerEvents, true );\n\t\twindow.addEventListener( 'click', handleClick, true );\n\t\tdocument.addEventListener( 'keydown', handleKeyDown, true );\n\n\t\t_hasInitialized = true;\n\t};\n\n\t\n\t//\n\t// Public APIs\n\t//\n\treturn _publicMethods;\n\n});\n"],"names":["root","factory","define","amd","exports","module","MailcheckInit","global","this","window","jQuery","removeSuggestions","_tempTarget","suggestions","parentNode","querySelectorAll","_settings","suggestionElementSelector","i","length","removeChild","classList","remove","mailFieldSuggestedClass","handleSuggested","suggestion","suggestedElementHtml","parent","suggestionHtml","suggestionTemplate","replaceAll","address","domain","suggestedElementTemplate","full","element","document","createElement","innerHTML","insertBefore","firstChild","nextSibling","add","handleTriggerEvents","e","undefined","Mailcheck","target","matches","mailFieldSelector","run","email","value","suggested","empty","handleClick","suggestionElement","closest","suggestionApplySelector","preventDefault","parentFormRow","formFieldWrapperSelector","targetField","querySelector","getAttribute","suggestionValueAttr","focus","CheckoutValidation","validateField","handleKeyDown","defaultPrevented","key","_key","_hasInitialized","_publicMethods","extend","extended","deep","Object","prototype","toString","call","arguments","obj","prop","hasOwnProperty","merge","init","options","addEventListener"],"mappings":"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"}