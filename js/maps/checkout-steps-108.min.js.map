{"version":3,"sources":["checkout-steps.js"],"names":["$","getFirstStepId","i","_frames","length","hasAttribute","getCurrentStepId","currentStep","document","querySelector","parseInt","getAttribute","getNextStepId","currentStepId","setCurrentStep","stepId","scrollToElement","frame","step","classList","remove","_steps","clearStepStatus","add","scrollTo","_progressBar","markStepsDone","handlePrevStepClick","e","preventDefault","getPrevStepId","init","_wfcWrapper","_wfcInner","firstChild","removeChild","querySelectorAll","label","createElement","setAttribute","textContent","contains","insertBefore","initSteps","body","element","window","scroll","behavior","left","top","offsetTop","addEventListener","target","closest","handleStepClick","fluidCheckoutValidation","validate_all_fields","handleNextStepClick","on","jQuery"],"mappings":"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","file":"../checkout-steps-108.min.js","sourcesContent":["/**\n * Manage checkout steps state.\n *\n * DEPENDS ON:\n * - jQuery // Interact with WooCommerce events\n */\n\n(function( $ ){\n\n  'use strict';\n\n  /**\n   * VARIABLES\n   */\n  var _initClass      = 'js-fluid-checkout-steps',\n      _wfcWrapper,\n  \t\t_wfcInner,\n  \t\t_progressBar,\n  \t\t_frames,\n  \t\t_steps;\n\n\n\n\t/**\n\t * METHODS\n\t */\n\t\n\t/**\n   * Get the id of current step.\n   */\n  var getFirstStepId = function() {\n    // Return next available step\n    for (var i = 0; i < _frames.length; i++) {\n      if ( ! _frames[ i + 1 ].hasAttribute( 'disabled' ) ) {\n        return i + 1;\n      }\n    }\n  };\n\n\n\n  /**\n\t * Get the id of current step.\n\t */\n\tvar getCurrentStepId = function() {\n\t\tvar currentStep = document.querySelector( '.wfc-step.current' );\n\t\treturn currentStep ? parseInt( currentStep.getAttribute( 'data-step-id' ) ) : null;\n\t};\n\n\n\n  /**\n   * Get the id of previous available step.\n   */\n  var getPrevStepId = function() {\n    var currentStepId = getCurrentStepId();\n\n\n    // Get first enabled step if not step is active\n    if ( ! currentStepId ) {\n      return getFirstStepId();\n    }\n\n    // Return next available step\n    for ( var i = currentStepId - 1; i >= 0; i-- ) {\n      if ( ! _frames[ i - 1 ].hasAttribute( 'disabled' ) ) {\n        return currentStepId - 1;\n      }\n    }\n\n    return 1;\n  };\n\n\n\n  /**\n   * Get the id of next available step.\n   */\n  var getNextStepId = function() {\n    var currentStepId = getCurrentStepId();\n\n    // Get first enabled step if not step is active\n    if ( ! currentStepId ) {\n      return getFirstStepId();\n    }\n\n    // Return next available step\n    for (var i = currentStepId - 1; i < _frames.length; i++) {\n      if ( ! _frames[ i + 1 ].hasAttribute('disabled') ) {\n        return currentStepId + 1;\n      }\n    }\n\n    return null;\n  };\n\n\n\n\t/**\n\t * Clear all step status\n\t */\n\tvar clearStepStatus = function() {\n\t\tfor (var i = _frames.length - 1; i >= 0; i--) {\n\t\t\t// active\n\t\t\t_frames[i].classList.remove( 'current' );\n\t\t\t_steps[i].classList.remove( 'current' );\n\t\t\t\n      // done\n\t\t\tif ( ! _steps[i].hasAttribute( 'disabled' ) ) {\n        _steps[i].classList.remove( 'done' );\n      }\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Mark steps as done.\n\t */\n\tvar markStepsDone = function() {\n\t\tvar currentStepId = getCurrentStepId();\n\t\tfor (var i = _steps.length - 1; i >= 0; i--) {\n\t\t\tvar stepId = _steps[i].getAttribute( 'data-step-id' );\n\t\t\tif ( ! _steps[i].hasAttribute( 'disabled' ) && stepId < currentStepId ) {\n\t\t\t\t_steps[i].classList.add( 'done' );\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Mark step as current.\n\t */\n\tvar markStepActive = function( step, frame, scrollToElement ) {\n\t\t// Set step as current\n\t\tstep.classList.add( 'current' );\n\t\tframe.classList.add( 'current' );\n\n    // TODO: Better animation handling with slide left/right depending on the position of the step\n    \n    // Maybe scroll step into view\n    if ( scrollToElement ) {\n      if ( _progressBar ) {\n        scrollTo( _progressBar );\n      }\n      else {\n        scrollTo( frame );\n      }\n    }\n\t};\n\n\n\n\t/**\n\t * Change current step.\n\t */\n\tvar setCurrentStep = function( stepId, scrollToElement ) {\n\t\tvar currentStepId = getCurrentStepId();\n\n    // Bail if is current active step\n    if ( currentStepId && currentStepId == stepId ) { return; }\n\t\t\n    var\tstep = document.querySelector( '#step-' + stepId ),\n\t\t\t\tframe = document.querySelector( '#frame-' + stepId );\n\t\t\n\t\t// Clear step status, mark as active and done\n\t\tclearStepStatus();\n\t\tmarkStepActive( step, frame, scrollToElement );\n\t\tmarkStepsDone();\n\t};\n\n\n\n\t/**\n\t * Create progress bar steps.\n\t */\n\tvar initSteps = function() {\n    // Bail if inner element not present\n    if ( ! _wfcInner ) { return; }\n\n    // Clear progress bar placeholders\n    while ( _progressBar.firstChild ) {\n      _progressBar.removeChild( _progressBar.firstChild );\n    }\n\n    // Get frames\n\t\t_frames = _wfcInner.querySelectorAll( '.wfc-frame' );\n\n\t\t// Add ID to each frame and steps to progress bar\n\t\tfor (var i = _frames.length - 1; i >= 0; i--) {\n\t\t\tvar stepId = i + 1,\n\t\t\t\t\tlabel = _frames[i].getAttribute( 'data-label' ),\n\t\t\t\t\tstep = document.createElement( 'div' );\n\n\t\t\tstep.classList.add('wfc-step');\n\t\t\tstep.setAttribute('id', 'step-' + stepId);\n\t\t\tstep.setAttribute('data-step-id', stepId);\n      step.textContent = label;\n\n      if ( _frames[i].hasAttribute('disabled') ) {\n        step.setAttribute('disabled', 'disabled');\n      }\n\n      if ( _frames[i].classList.contains('done') ) {\n        step.classList.add('done');\n      }\n\n\t\t\t_progressBar.insertBefore(step, _progressBar.firstChild);\n\t\t\t\n\t\t\t_frames[i].setAttribute('id', 'frame-' + stepId);\n\t\t\t_frames[i].setAttribute('data-frame-id', stepId);\n\t\t}\n\n\t\t// Get steps\n\t\t_steps = _wfcInner.querySelectorAll('.wfc-step');\n\n\t\t// Show first available step\n\t\tsetCurrentStep( getNextStepId(), false );\n\t};\n\n\n\n  /**\n   * Scroll element into viewport.\n   * @param  {Element} element Element to get position and scroll viewport to.\n   */\n  var scrollTo = function( element ) {\n    window.scroll({\n      behavior: 'smooth',\n      left: 0,\n      top: element.offsetTop\n    });\n  };\n\n\n\t\n\t/**\n\t * Handle clicks on steps progress bar.\n\t */\n\tvar handleStepClick = function( e ) {\n    e.preventDefault();\n    var step = e.target.closest( '[data-step-id]' );\n    setCurrentStep( step.getAttribute( 'data-step-id' ), true );\n\t};\n\n\n\n\t/**\n\t * Handle clicks on next step buttons.\n\t */\n\tvar handleNextStepClick = function( e ) {\n    e.preventDefault();\n\n    // Validate step fields\n    if ( window.fluidCheckoutValidation ) {\n      var currentStepId = getCurrentStepId(),\n          frame = _wfcWrapper.querySelector( '#frame-' + currentStepId );\n      \n      // Bail if not all fields valid and stay in the same step\n      if ( ! window.fluidCheckoutValidation.validate_all_fields( frame ) ) {\n        var element = frame.querySelector( '.woocommerce-invalid' );\n        scrollTo( element );\n        return;\n      }\n    }\n\n    // Go to next step\n    setCurrentStep( getNextStepId(), true );\n\n\t};\n\n\n\n  /**\n   * Handle clicks on previous step buttons.\n   */\n  var handlePrevStepClick = function( e ) {\n    e.preventDefault();\n\n    // Go to prev step\n    setCurrentStep( getPrevStepId(), true );\n  };\n\n\n\n\t/**\n   * Handle document clicks and route to the appropriate function.\n   */\n  var handleClick = function( e ) {\n    if ( e.target.closest( '[data-step-id]:not([disabled])' ) ) {\n      handleStepClick( e );\n    }\n    else if ( e.target.closest( '.wfc-prev:not([disabled])' ) ) {\n      handlePrevStepClick( e );\n    }\n    else if ( e.target.closest( '.wfc-next:not([disabled])' ) ) {\n    \thandleNextStepClick( e );\n    }\n  };\n\n\n\n  /**\n   * Set plugin as active.\n   */\n  var setPluginActive = function() {\n  \t_wfcWrapper.classList.add('active');\n  };\n\n\n\n  /**\n   * Initialize component and set related handlers.\n   */\n  var init = function() {\n    _wfcWrapper = document.querySelector('#wfc-wrapper');\n    _wfcInner = document.querySelector('.wfc-inside');\n    _progressBar = document.querySelector('#wfc-progressbar');\n\n    // Bail if elements not present\n    if ( ! _wfcWrapper || ! _wfcInner || ! _progressBar ) { return; }\n\n  \tinitSteps();\n  \tsetPluginActive();\n\n    // Add init class\n    document.body.classList.add( _initClass );\n  };\n\n\n\n  // Add event listeners\n  window.addEventListener( 'click', handleClick );\n  window.addEventListener( 'load', init );\n\n  // Run on checkout or cart changes\n  $( document ).on( 'load_ajax_content_done', init );\n\n\n\n})( jQuery );\n"]}