{"version":3,"file":"../checkout-layout-110-dev-2.min.js","sources":["checkout-layout.js"],"sourcesContent":["/**\n * Manage checkout steps state.\n *\n * DEPENDS ON:\n * - jQuery // Interact with WooCommerce events\n */\n(function (root, factory) {\n\tif ( typeof define === 'function' && define.amd ) {\n\t\tdefine([], factory(root));\n\t} else if ( typeof exports === 'object' ) {\n\t\tmodule.exports = factory(root);\n\t} else {\n\t\troot.CheckoutSteps = factory(root);\n\t}\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\n\n\t'use strict';\n\n\tvar $ = jQuery;\n\n\tvar _hasInitialized = false;\n\tvar _publicMethods = { };\n\tvar _settings = {\n\t\tinitClass: 'js-wfc-steps',\n\t}\n\n\tvar _wfcWrapper,\n\t\t_wfcInner,\n\t\t_progressBar,\n\t\t_frames,\n\t\t_steps;\n\n\n\n\t/**\n\t * METHODS\n\t */\n\t\n\t/**\n\t * Get the id of current step.\n\t */\n\tvar getFirstStepId = function() {\n\t\t// Return next available step\n\t\tfor (var i = 0; i < _frames.length; i++) {\n\t\t\tif ( ! _frames[ i + 1 ].hasAttribute( 'disabled' ) ) {\n\t\t\t\treturn i + 1;\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Get the id of current step.\n\t */\n\tvar getCurrentStepId = function() {\n\t\tvar currentStep = document.querySelector( '.wfc-step.current' );\n\t\treturn currentStep ? parseInt( currentStep.getAttribute( 'data-step-id' ) ) : null;\n\t};\n\n\n\n\t/**\n\t * Get the id of previous available step.\n\t */\n\tvar getPrevStepId = function() {\n\t\tvar currentStepId = getCurrentStepId();\n\n\n\t\t// Get first enabled step if not step is active\n\t\tif ( ! currentStepId ) {\n\t\t\treturn getFirstStepId();\n\t\t}\n\n\t\t// Return next available step\n\t\tfor ( var i = currentStepId - 1; i >= 0; i-- ) {\n\t\t\tif ( ! _frames[ i - 1 ].hasAttribute( 'disabled' ) ) {\n\t\t\t\treturn currentStepId - 1;\n\t\t\t}\n\t\t}\n\n\t\treturn 1;\n\t};\n\n\n\n\t/**\n\t * Get the id of next available step.\n\t */\n\tvar getNextStepId = function() {\n\t\tvar currentStepId = getCurrentStepId();\n\n\t\t// Get first enabled step if not step is active\n\t\tif ( ! currentStepId ) {\n\t\t\treturn getFirstStepId();\n\t\t}\n\n\t\t// Return next available step\n\t\tfor (var i = currentStepId - 1; i < _frames.length; i++) {\n\t\t\tif ( ! _frames[ i + 1 ].hasAttribute('disabled') ) {\n\t\t\t\treturn currentStepId + 1;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\n\n\t/**\n\t * Clear all step status\n\t */\n\tvar clearStepStatus = function() {\n\t\tfor (var i = _frames.length - 1; i >= 0; i--) {\n\t\t\t// active\n\t\t\t_frames[i].classList.remove( 'current' );\n\t\t\t_steps[i].classList.remove( 'current' );\n\t\t\t\n\t\t\t// done\n\t\t\tif ( ! _steps[i].hasAttribute( 'disabled' ) ) {\n\t\t\t\t_steps[i].classList.remove( 'done' );\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Mark steps as done.\n\t */\n\tvar markStepsDone = function() {\n\t\tvar currentStepId = getCurrentStepId();\n\t\tfor (var i = _steps.length - 1; i >= 0; i--) {\n\t\t\tvar stepId = _steps[i].getAttribute( 'data-step-id' );\n\t\t\tif ( ! _steps[i].hasAttribute( 'disabled' ) && stepId < currentStepId ) {\n\t\t\t\t_steps[i].classList.add( 'done' );\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Mark step as current.\n\t */\n\tvar markStepActive = function( step, frame, scrollToElement ) {\n\t\t// Set step as current\n\t\tstep.classList.add( 'current' );\n\t\tframe.classList.add( 'current' );\n\n\t\t// TODO: Better animation handling with slide left/right depending on the position of the step\n\t\t\n\t\t// Maybe scroll step into view\n\t\tif ( scrollToElement ) {\n\t\t\tif ( _progressBar ) {\n\t\t\t\tscrollTo( _progressBar );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tscrollTo( frame );\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Change current step.\n\t */\n\tvar setCurrentStep = function( stepId, scrollToElement ) {\n\t\tvar currentStepId = getCurrentStepId();\n\n\t\t// Bail if is current active step\n\t\tif ( currentStepId && currentStepId == stepId ) { return; }\n\t\t\n\t\tvar\tstep = document.querySelector( '#step-' + stepId ),\n\t\t\t\tframe = document.querySelector( '#frame-' + stepId );\n\t\t\n\t\t// Clear step status, mark as active and done\n\t\tclearStepStatus();\n\t\tmarkStepActive( step, frame, scrollToElement );\n\t\tmarkStepsDone();\n\t};\n\n\n\n\t/**\n\t * Create progress bar steps.\n\t */\n\tvar initSteps = function() {\n\t\t// Bail if inner element not present\n\t\tif ( ! _wfcInner ) { return; }\n\n\t\t// Clear progress bar placeholders\n\t\twhile ( _progressBar.firstChild ) {\n\t\t\t_progressBar.removeChild( _progressBar.firstChild );\n\t\t}\n\n\t\t// Get frames\n\t\t_frames = _wfcInner.querySelectorAll( '.wfc-frame' );\n\n\t\t// Add ID to each frame and steps to progress bar\n\t\tfor (var i = _frames.length - 1; i >= 0; i--) {\n\t\t\tvar stepId = i + 1,\n\t\t\t\t\tlabel = _frames[i].getAttribute( 'data-label' ),\n\t\t\t\t\tstep = document.createElement( 'div' );\n\n\t\t\tstep.classList.add('wfc-step');\n\t\t\tstep.setAttribute('id', 'step-' + stepId);\n\t\t\tstep.setAttribute('data-step-id', stepId);\n\t\t\tstep.textContent = label;\n\n\t\t\tif ( _frames[i].hasAttribute('disabled') ) {\n\t\t\t\tstep.setAttribute('disabled', 'disabled');\n\t\t\t}\n\n\t\t\tif ( _frames[i].classList.contains('done') ) {\n\t\t\t\tstep.classList.add('done');\n\t\t\t}\n\n\t\t\t_progressBar.insertBefore(step, _progressBar.firstChild);\n\t\t\t\n\t\t\t_frames[i].setAttribute('id', 'frame-' + stepId);\n\t\t\t_frames[i].setAttribute('data-frame-id', stepId);\n\t\t}\n\n\t\t// Get steps\n\t\t_steps = _wfcInner.querySelectorAll('.wfc-step');\n\n\t\t// Show first available step\n\t\tsetCurrentStep( getNextStepId(), false );\n\t};\n\n\n\n\t/**\n\t * Scroll element into viewport.\n\t * @param  {Element} element Element to get position and scroll viewport to.\n\t */\n\tvar scrollTo = function( element ) {\n\t\twindow.scroll({\n\t\t\tbehavior: 'smooth',\n\t\t\tleft: 0,\n\t\t\ttop: element.offsetTop\n\t\t});\n\t};\n\n\n\t\n\t/**\n\t * Handle clicks on steps progress bar.\n\t */\n\tvar handleStepClick = function( e ) {\n\t\te.preventDefault();\n\t\tvar step = e.target.closest( '[data-step-id]' );\n\t\tsetCurrentStep( step.getAttribute( 'data-step-id' ), true );\n\t};\n\n\n\n\t/**\n\t * Handle clicks on next step buttons.\n\t */\n\tvar handleNextStepClick = function( e ) {\n\t\te.preventDefault();\n\n\t\t// Validate step fields\n\t\tif ( window.CheckoutValidation ) {\n\t\t\tvar currentStepId = getCurrentStepId(),\n\t\t\t\t\tframe = _wfcWrapper.querySelector( '#frame-' + currentStepId );\n\t\t\t\n\t\t\t// Bail if not all fields valid and stay in the same step\n\t\t\tif ( ! window.CheckoutValidation.validateAllFields( frame ) ) {\n\t\t\t\tvar element = frame.querySelector( '.woocommerce-invalid' );\n\t\t\t\tscrollTo( element );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Go to next step\n\t\tsetCurrentStep( getNextStepId(), true );\n\n\t};\n\n\n\n\t/**\n\t * Handle clicks on previous step buttons.\n\t */\n\tvar handlePrevStepClick = function( e ) {\n\t\te.preventDefault();\n\n\t\t// Go to prev step\n\t\tsetCurrentStep( getPrevStepId(), true );\n\t};\n\n\n\n\t/**\n\t * Handle document clicks and route to the appropriate function.\n\t */\n\tvar handleClick = function( e ) {\n\t\tif ( e.target.closest( '[data-step-id]:not([disabled])' ) ) {\n\t\t\thandleStepClick( e );\n\t\t}\n\t\telse if ( e.target.closest( '.wfc-prev:not([disabled])' ) ) {\n\t\t\thandlePrevStepClick( e );\n\t\t}\n\t\telse if ( e.target.closest( '.wfc-next:not([disabled])' ) ) {\n\t\t\thandleNextStepClick( e );\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Set plugin as active.\n\t */\n\tvar setPluginActive = function() {\n\t\t_wfcWrapper.classList.add('active');\n\t};\n\n\n\n\t/**\n\t * Initialize component and set related handlers.\n\t */\n\t_publicMethods.refreshSteps = function() {\n\t\t_wfcWrapper = document.querySelector( '#wfc-wrapper' );\n\t\t_wfcInner = document.querySelector( '.wfc-inside' );\n\t\t_progressBar = document.querySelector( '#wfc-progressbar' );\n\n\t\t// Bail if elements not present\n\t\tif ( ! _wfcWrapper || ! _wfcInner || ! _progressBar ) { return; }\n\n\t\tinitSteps();\n\t\tsetPluginActive();\n\t}\n\n\n\n\t/**\n\t * Initialize component and set related handlers.\n\t */\n\t_publicMethods.init = function() {\n\t\tif ( _hasInitialized ) return;\n\n\t\t_publicMethods.refreshSteps();\n\n\t\t// Add init class\n\t\tdocument.body.classList.add( _settings.initClass );\n\n\t\t// Add event listeners\n\t\twindow.addEventListener( 'click', handleClick );\n\t\t$( document ).on( 'load_ajax_content_done', _publicMethods.refreshSteps );\n\n\t\t_hasInitialized = true;\n\t};\n\n\n\n\t//\n\t// Public APIs\n\t//\n\treturn _publicMethods;\n\n});\n"],"names":["root","factory","define","amd","exports","module","CheckoutSteps","global","this","window","getFirstStepId","i","_frames","length","hasAttribute","getCurrentStepId","currentStep","document","querySelector","parseInt","getAttribute","getNextStepId","currentStepId","setCurrentStep","stepId","scrollToElement","step","frame","classList","remove","_steps","clearStepStatus","add","scrollTo","_progressBar","markStepsDone","handlePrevStepClick","e","preventDefault","getPrevStepId","handleClick","target","closest","handleStepClick","CheckoutValidation","_wfcWrapper","validateAllFields","element","handleNextStepClick","_wfcInner","$","jQuery","_hasInitialized","_publicMethods","_settings","scroll","behavior","left","top","offsetTop","refreshSteps","firstChild","removeChild","querySelectorAll","label","createElement","setAttribute","textContent","contains","insertBefore","initSteps","init","body","addEventListener","on"],"mappings":"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"}