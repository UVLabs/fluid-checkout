!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.CollapsibleBlock=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function r(){var n={},i=!1,e=0;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(i=arguments[0],e++);e<arguments.length;e++)!function(e){for(var t in e)e.hasOwnProperty(t)&&(i&&"[object Object]"===Object.prototype.toString.call(e[t])?n[t]=r(n[t],e[t]):n[t]=e[t])}(arguments[e]);return n}function o(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e];return"transitionend"}function s(e){(e=e||document.body).offsetHeight}function c(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function d(e){var t;e.target.closest(y.handlerSelector)&&e.target.closest(y.handlerMultiTargetSelector)?(e.preventDefault(),function(e){if(e)for(var t=e.getAttribute(y.multiTargetAttribute).split(","),n=0;n<t.length;n++){var i=t[n],i=document.querySelector("#"+i.trim());!i||(i=i.closest(y.elementSelector))&&E.toggleState(i)}}(t=e.target.closest(y.handlerMultiTargetSelector))):e.target.closest(y.handlerSelector)&&(e.preventDefault(),!(t=t=e.target.closest(y.handlerSelector))||(t=(document.querySelector("#"+t.getAttribute(y.targetAttribute))||t).closest(y.elementSelector))&&E.toggleState(t))}function m(e){e.defaultPrevented||e.key!=t&&e.key!=n||!e.target.closest(y.handlerSelector)||d(e)}function l(e){var t=e.style.position,n=e.style.display,i=e.style.visibility,l=e.style.transition,a=e.style.height;e.style.position="absolute",e.style.display="block",e.style.visibility="hidden",e.style.transition="none",e.style.height="";var s=e.scrollHeight;return e.style.position=t,e.style.display=n,e.style.visibility=i,e.style.transition=l,e.style.height=a,s}function a(e){return e.getBoundingClientRect().height}function u(e,t,n){var i;(n=!1!==n)||(i=e.style.transition,e.style.transition="none"),e.style.height=t+"px",n||(s(e),e.style.transition=i)}function g(e){E.expand(e.element),requestAnimationFrame(function(){l(e.contentElement)>e.settings.maxHeight&&E.collapse(e.element)})}function b(e,t){if(e||"boolean"==typeof t)for(var n=document.querySelectorAll("["+y.targetAttribute+"="+e.id+"]"),i=0;i<n.length;i++)n[i].setAttribute("aria-expanded",t)}function f(e){if(e&&!("propertyName"in e&&"height"!==e.propertyName)){"target"in e&&e.target&&(e=e.target);var t=E.getInstance(e.closest(y.elementSelector));if(e.style.height="",e.style.overflow="",b(e,!0),t&&!0===t.isActivated){var n=null,i=e.querySelectorAll(y.autoFocusSelector);if(!n&&i)for(var l=0;l<i.length;l++){var a=i[l];a.closest(y.contentElementSelector)===e&&c(a)&&(n=a)}if(!n&&e.matches(y.autoFocusSelector))for(var s=Array.from((e||document).querySelectorAll(y.focusableElementsSelector)),l=0;l<s.length;l++){var r=s[l];if(c(r)){n=r;break}}n&&(n.focus(),y.selectContentsOnFocus&&n.select())}e.removeEventListener(o(),f)}}function h(e){e&&("propertyName"in e&&"height"!==e.propertyName||((e="target"in e&&e.target?e.target:e).style.display="none",b(e,!1),e.removeEventListener(o(),h)))}var p=!1,E={managers:[],states:{COLLAPSED:"collapsed",FIRST_EXPANDED:"first-expanded",EXPANDED:"expanded"}},y={},v={bodyClass:"has-collapsible-block",elementSelector:"[data-collapsible]",contentElementSelector:"[data-collapsible-content]",contentInnerSelector:".collapsible-content__inner",handlerSelector:"[data-collapsible-handler]",handlerMultiTargetSelector:"[data-collapsible-targets]",autoFocusSelector:"[data-autofocus]",focusableElementsSelector:'a[href], button:not([disabled]), input:not([disabled]):not([type="hidden"]), textarea:not([disabled]), select:not([disabled]), details, summary, iframe, object, embed, [contenteditable] [tabindex]:not([tabindex="-1"])',selectContentsOnFocus:!0,isCollapsedClass:"is-collapsed",isExpandedClass:"is-expanded",isActivatedClass:"is-activated",cssTransition:"height .15s linear",targetAttribute:"aria-controls",multiTargetAttribute:"data-collapsible-targets",maxHeightAttribute:"data-collapsible-max-height",createHandlerAttribute:"data-collapsible-create-handler",changeStateOnResizeAttribute:"data-collapsible-change-state-resize",initialState:E.states.FIRST_EXPANDED,initialStateAttribute:"data-collapsible-initial-state",idPrefix:"collapsible",createHandler:!1,maxHeight:0,handlerTemplate:'<a href="#collapsible" role="button" data-collapsible-handler>Read more</a>',contentInnerTemplate:'<div class="collapsible-content__inner"></div>'},t="Enter",n=" ";return E.getInstance=function(e){for(var t,n=0;n<E.managers.length;n++){var i=E.managers[n];if(i.element==e){t=i;break}}return t},E.collapse=function(e,t){var n=E.getInstance(e);n&&(t=!1!==t,n.element.classList.add(n.settings.isCollapsedClass),n.element.classList.remove(n.settings.isExpandedClass),n.contentElement.removeEventListener(o(),f),n.contentElement.style.overflow="hidden",u(n.contentElement,a(n.contentElement),!1),t&&n.contentElement.addEventListener(o(),h),s(e),u(n.contentElement,n.settings.maxHeight,t),t||h(n.contentElement))},E.expand=function(t,n){var i=E.getInstance(t);i&&(n=!1!==n,i.contentElement.style.display="",i.contentElement.removeEventListener(o(),h),u(i.contentElement,a(i.contentElement),!1),n&&i.contentElement.addEventListener(o(),f),requestAnimationFrame(function(){var e=l(i.contentElement);s(t),u(i.contentElement,e,n),i.element.classList.add(i.settings.isExpandedClass),i.element.classList.remove(i.settings.isCollapsedClass),n||f(i.contentElement)}))},E.toggleState=function(e,t){var n=E.getInstance(e);n&&(e.classList.contains(n.settings.isCollapsedClass)?E.expand(e,t):E.collapse(e,t))},E.getState=function(e){var t=E.getInstance(e);if(!t)return!1;var n=E.states.EXPANDED;return n=e.classList.contains(t.settings.isCollapsedClass)?E.states.COLLAPSED:n},E.initializeHandler=function(e){e.removeAttribute("disabled"),e.removeAttribute("aria-hidden"),e.setAttribute("tabindex","0"),"BUTTON"!=e.tagName.toUpperCase()&&e.setAttribute("role","button");var t=e.getAttribute(y.targetAttribute),n=e.getAttribute(y.multiTargetAttribute);t&&""!=t||n&&""!=n||((n=e.closest(y.elementSelector))&&n.matches(y.contentElementSelector)?t=n.id:n&&n.querySelector(y.contentElementSelector)&&(t=n.querySelector(y.contentElementSelector).id),t&&""!=t&&e.setAttribute(y.targetAttribute,t)),e.removeAttribute("href")},E.initializeElement=function(e){var t={};E.managers.push(t),t.element=e,t.settings=r(y),t.contentElement=t.element.matches(y.contentElementSelector)?t.element:t.element.querySelector(t.settings.contentElementSelector),t.contentElement||(t.contentElement=t.element),""==t.element.id&&(t.element.id=t.settings.idPrefix+"_"+E.managers.length),""==t.contentElement.id&&(t.contentElement.id=t.element.id+"__content");var n=t.contentElement.getAttribute(t.settings.maxHeightAttribute);t.settings.maxHeight=n&&""!=n?parseInt(n):t.settings.maxHeight;var i,l=t.element.getAttribute(t.settings.createHandlerAttribute);t.settings.createHandler="true"==l||"false"==l?Boolean(l):t.settings.createHandler,t.settings.createHandler&&(n=(e=t).element,i=e.contentElement,(l=document.createElement("div")).innerHTML=e.settings.handlerTemplate.trim(),e.handlerElement=l.childNodes[0],e.handlerElement.setAttribute(e.settings.targetAttribute,i.id),n.insertBefore(l.childNodes[0],i.nextSibling)),(i=t).contentElement.querySelector(i.settings.contentInnerSelector)||(a=i.contentElement,(s=document.createElement("div")).innerHTML=i.settings.contentInnerTemplate.trim(),s.childNodes[0].innerHTML=a.innerHTML,a.innerHTML=s.innerHTML);var a=t.contentElement.getAttribute(t.settings.initialStateAttribute),s=a||t.settings.initialState,a=Array.prototype.indexOf.call(t.element.parentNode.children,t.element);s==E.states.EXPANDED||s==E.states.FIRST_EXPANDED&&0==a?E.expand(t.element,!1):E.collapse(t.element,!1);a=t.element.getAttribute(t.settings.changeStateOnResizeAttribute);t.settings.changeStateOnResize=!(!a||""==a)&&Boolean(a),t.settings.changeStateOnResize&&(g(t),window.addEventListener("resize",function(){g(t)}));a=window.getComputedStyle(t.contentElement).transition,a=""!=a?a+", "+t.settings.cssTransition:t.settings.cssTransition;t.contentElement.style.transition=a,requestAnimationFrame(function(){t.isActivated=!0,t.element.classList.add(t.settings.isActivatedClass)})},E.init=function(e){if(!p){y=r(v,e);for(var t=document.querySelectorAll(y.elementSelector),n=0;n<t.length;n++)E.initializeElement(t[n]);for(var i=document.querySelectorAll(y.handlerSelector),n=0;n<i.length;n++)E.initializeHandler(i[n]);s();for(n=0;n<t.length;n++){var l=t[n],a=l.matches(y.contentElementSelector)?l:l.querySelector(y.contentElementSelector);b(a,E.getState(l)==E.states.EXPANDED)}document.addEventListener("click",d),document.addEventListener("keydown",m,!0),document.body.classList.add(y.bodyClass),requestAnimationFrame(function(){p=!0})}},E});